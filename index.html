<head>
  <meta charset="UTF-8">
  <style>
  [contenteditable="true"]:focus {
    outline: none;
   }
    pre{
    	tab-size: 4;
    }
   </style>

</head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.10.2/beautify.js"></script>
<link rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.16.2/build/styles/monokai-sublime.min.css">
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.16.2/build/highlight.min.js"></script>

<script src="hanzi2num.js"></script>
<script src="hanzi2pinyin.js"></script>
<script src="parser.js"></script>
<script src="highlight.js"></script>
<body style="background:#272822;padding:20px;color:white;font-family:sans-serif;">
	<h2><i>wenyan-lang</i></h2>
<table><tr><td><button id="run">Run</button></td></tr><tr><td id="in"></td><td><pre id="js"></pre></td></tr><tr><td><pre id="out"></pre></td></tr></table>
<script>
	

	var ed = newEditor(`吾有一言。曰「「問天地好在。」」。書之。
有數三十。名之曰「甲」。
吾有三言。曰「「甲之數」」。曰「甲」。曰「「也」」。書之。

批曰。「「文氣淋灕。字句切實」」。

吾有二爻。曰陽。曰陰。名之曰「天」。曰「地」。
夫「天」「地」中無陰乎。夫「天」「地」中有陽乎。噫。
變「天」。名之曰「人」。

減「甲」以一。加「甲」以二。名之曰「乙」。曰「丙」。

吾有一列。名之曰「丁」。
充「丁」以一。以二。以三。以四。

有數一。名之曰「戊」。
恆為是。
	若「戊」等於三者。
		乃止
	也。
	加一於「戊」。昔之「戊」者。今其是矣。
云云。

吾有一術。名之曰「階乘」。欲行是術。必先得一數。曰「甲」。乃行是術曰。
	若「甲」等於一者。
		乃得「甲」。
	若非。
		減「甲」以一。名之曰「乙」。
		施「階乘」於「乙」。名之曰「丙」。
		乘「丙」以「甲」。名之曰「丁」。
		乃得「丁」
	也。
是謂「階乘」之術也。

吾有一術。名之曰「異或」。欲行是術。必先得二爻。曰「甲」。曰「乙」。乃行是術曰。
	若「甲」等於「乙」者。
		乃得陰。
	若非。
		乃得陽
	也。
是謂「異或」之術也。

吾有一術。名之曰「快排」。欲行是術。必先得一列。曰「甲」。乃行是術曰。
	若「甲」之長弗大於一者。
		乃得「甲」
	也。
	吾有三列。名之曰「首」。曰「頷」。曰「尾」。

	夫「甲」之一。名之曰「甲一」。
	充「頷」以「甲一」。
	夫「甲」之其餘。名之曰「甲餘」。

	凡「甲餘」中之「丁」。
		若「丁」小於「甲一」者。
			充「首」以「丁」。
		若非。
			充「尾」以「丁」
		也。
	云云。
	施「快排」於「首」。昔之「首」者。今其是矣。
	施「快排」於「尾」。昔之「尾」者。今其是矣。

	銜「首」以「頷」以「尾」。名之曰「乙」。
	乃得「乙」。

是謂「快排」之術也。`)
	document.getElementById("in").append(ed);
	document.getElementById("run").onclick=function(){
		highlight([ed]);
		document.getElementById("out").innerText="";
		var code = compile('js',ed.innerText,{romanizeIdentifiers:true});
		document.getElementById("js").innerText=js_beautify(code);
		hljs.highlightBlock(document.getElementById("js"));
		code = code.replace(/console.log\(/g, `log2div(`);
		eval(code);
	}
	function log2div(){
		var outdiv = document.getElementById("out");
		for (var i = 0; i < arguments.length; i++){
			outdiv.innerText += arguments[i];
		}
		outdiv.innerText+="\n";
	}
</script>
</body>